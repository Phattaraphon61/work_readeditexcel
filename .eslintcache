[{"C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\index.js":"1","C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\App.js":"2","C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\reportWebVitals.js":"3","C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\components\\excelPage.js":"4","C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\utils\\editable.js":"5","C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\components\\login.js":"6"},{"size":1216,"mtime":1618578572036,"results":"7","hashOfConfig":"8"},{"size":528,"mtime":1618470410934,"results":"9","hashOfConfig":"10"},{"size":362,"mtime":1618470410934,"results":"11","hashOfConfig":"10"},{"size":12535,"mtime":1618833191969,"results":"12","hashOfConfig":"8"},{"size":2034,"mtime":1618340067703,"results":"13","hashOfConfig":"8"},{"size":24609,"mtime":1619013116234,"results":"14","hashOfConfig":"8"},{"filePath":"15","messages":"16","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"17","usedDeprecatedRules":"18"},"nluw39",{"filePath":"19","messages":"20","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1e5ufvf",{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"23","messages":"24","errorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"25","usedDeprecatedRules":"18"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"18"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\index.js",["30","31","32","33"],"// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import reportWebVitals from './reportWebVitals';\n\n// ReactDOM.render(\n//   <React.StrictMode>\n//     <App />\n//   </React.StrictMode>,\n//   document.getElementById('root')\n// );\n\n// // If you want to start measuring performance in your app, pass a function\n// // to log results (for example: reportWebVitals(console.log))\n// // or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"antd/dist/antd.css\";\nimport { useRoutes, BrowserRouter } from \"react-router-dom\";\nimport ExcelPage from \"./components/excelPage\";\nimport LoginDemo from \"./components/login\"\n\n\nfunction App() {\n\n\n  return(\n    <LoginDemo/>\n  )\n  // const routes = [\n  //   {\n  //     path: \"/\",\n  //     element: <LoginDemo />,\n  //   },\n  //   {\n  //     path: \"home\",\n  //     element: <ExcelPage />,\n  //   }\n  // ];\n\n  // const routing = useRoutes(routes);\n  // return <div>{routing}</div>;\n}\n\nconst rootElement = document.getElementById(\"root\");\nReactDOM.render(\n  \n    <App />\n ,\n  document.getElementById(\"root\"))\n",["34","35"],"C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\App.js",[],"C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\reportWebVitals.js",[],"C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\components\\excelPage.js",["36","37","38","39","40","41","42","43","44","45","46"],"import React, { Component } from \"react\";\nimport { Table, Button, Popconfirm, Row, Col, Icon, Upload, Typography, Space, message } from \"antd\";\nimport { ExcelRenderer } from \"react-excel-renderer\";\nimport { EditableFormRow, EditableCell } from \"../utils/editable\";\nimport ExportJsonExcel from 'js-export-excel';\nconst { Text } = Typography;\nexport default class ExcelPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      cols: [],\n      rows: [],\n      name: null,\n      errorMessage: null,\n      columns: [\n        {\n          title: \"ICD-10\",\n          dataIndex: \"ICD_10\",\n          // render: text => text\n        },\n        {\n          title: \"ICD-9\",\n          dataIndex: \"ICD_9\",\n\n        },\n        {\n          title: \"รหัสกรมบัญชีกลาง.\",\n          dataIndex: \"g1\",\n\n        },\n        {\n          title: \"อุปกรณ์\",\n          dataIndex: \"g2\",\n\n        },\n        {\n          title: \"อัตราจ่าย\",\n          dataIndex: \"g3\",\n\n        },\n        // {\n        //   title: \"Action\",\n        //   dataIndex: \"action\",\n        //   render: (text, record) =>\n        //     this.state.rows.length >= 1 ? (\n        //       <Popconfirm\n        //         title=\"Sure to delete?\"\n        //         onConfirm={() => this.handleDelete(record.key)}\n        //       >\n        //         <Icon\n        //           type=\"delete\"\n        //           theme=\"filled\"\n        //           style={{ color: \"red\", fontSize: \"20px\" }}\n        //         />\n        //       </Popconfirm>\n        //     ) : null\n        // }\n      ]\n    };\n  }\n\n  error = () => {\n    message.error('ข้อมูลยังไม่ครบ');\n  };\n\n  handleSave = row => {\n    var dict = {\n      '2505': \"เครื่องละ 9,000 บาท\",\n      '2507': 'ข้างละ 12,000 บาท',\n      '2508': 'ข้างละ 12,500 บาท',\n      '8101': 'ข้างละ 36,500 บาท',\n      '8105': 'ข้างละ 48,000 บาท',\n      '8106': 'ข้างละ 38,000 บาท',\n      '8202': 'ข้างละ 6,000 บาท',\n      '8203': 'ข้างละ 12,000 บาท',\n      '8206': 'ข้างละ 28,000 บาท',\n      '8801': 'คู่ละ 800 บาท',\n      '8802': 'คู่ละ 1,000 บาท',\n      '8803': 'คู่ละ 1,200 บาท',\n      '8804': 'คู่ละ 1,400 บาท',\n      '2006': 'อันละ 2,800 บาท',\n      '2007': 'อันละ 700 บาท',\n      '8201': 'ข้างละ 11,000 บาท',\n      '8221': 'ข้างละ 6,000 บาท',\n      '8205': 'ข้างละ 26,000 บาท',\n    };\n    const newData = [...this.state.rows];\n    const index = newData.findIndex(item => row.key === item.key);\n    const item = newData[index];\n    newData.splice(index, 1, {\n      ...item,\n      ...row\n    });\n    // console.log(item.includes(undefined))\n    this.setState({ rows: newData });\n    if (newData[index]['ICD_10'] && newData[index]['ICD_9'] && newData[index]['g1'] && newData[index]['g2'] !== undefined) {\n      let temporaryarray = newData.slice();\n      temporaryarray[index]['g3'] = dict[newData[index]['g1']];\n      this.setState(temporaryarray);\n    }\n  };\n\n  checkFile(file) {\n    let errorMessage = \"\";\n    if (!file || !file[0]) {\n      return;\n    }\n    const isExcel =\n      file[0].type === \"application/vnd.ms-excel\" ||\n      file[0].type ===\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\";\n    if (!isExcel) {\n      errorMessage = \"You can only upload Excel file!\";\n    }\n    console.log(\"file\", file[0].type);\n    const isLt2M = file[0].size / 1024 / 1024 < 2;\n    if (!isLt2M) {\n      errorMessage = \"File must be smaller than 2MB!\";\n    }\n    console.log(\"errorMessage\", errorMessage);\n    return errorMessage;\n  }\n\n  fileHandler = fileList => {\n    // console.log(\"fileList\", fileList);\n    this.setState({ name: fileList.name.split(\".\")[0] });\n    let fileObj = fileList;\n    if (!fileObj) {\n      this.setState({\n        errorMessage: \"No file uploaded!\"\n      });\n      return false;\n    }\n    console.log(\"fileObj.type:\", fileObj.type);\n    if (\n      !(\n        fileObj.type === \"application/vnd.ms-excel\" ||\n        fileObj.type ===\n        \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n      )\n    ) {\n      this.setState({\n        errorMessage: \"Unknown file format. Only Excel files are uploaded!\"\n      });\n      return false;\n    }\n    //just pass the fileObj as parameter\n    ExcelRenderer(fileObj, (err, resp) => {\n      if (err) {\n        console.log(err);\n      } else {\n        let newRows = [];\n        var dict = {\n          '2505': \"เครื่องละ 9,000 บาท\",\n          '2507': 'ข้างละ 12,000 บาท',\n          '2508': 'ข้างละ 12,500 บาท',\n          '8101': 'ข้างละ 36,500 บาท',\n          '8105': 'ข้างละ 48,000 บาท',\n          '8106': 'ข้างละ 38,000 บาท',\n          '8202': 'ข้างละ 6,000 บาท',\n          '8203': 'ข้างละ 12,000 บาท',\n          '8206': 'ข้างละ 28,000 บาท',\n          '8801': 'คู่ละ 800 บาท',\n          '8802': 'คู่ละ 1,000 บาท',\n          '8803': 'คู่ละ 1,200 บาท',\n          '8804': 'คู่ละ 1,400 บาท',\n          '2006': 'อันละ 2,800 บาท',\n          '2007': 'อันละ 700 บาท',\n          '8201': 'ข้างละ 11,000 บาท',\n          '8221': 'ข้างละ 6,000 บาท',\n          '8205': 'ข้างละ 26,000 บาท',\n        };\n        resp.rows.slice(1).map((row, index) => {\n          if (row && row !== \"undefined\") {\n            if (row.includes(undefined) == true) {\n\n              newRows.push({\n                key: index,\n                // ICD_10: <Text type=\"danger\">{row[0]}</Text>,\n                // ICD_9: <Text type=\"danger\">{row[1]}</Text>,\n                // g1: <Text type=\"danger\">{row[2]}</Text>,\n                // g2: <Text type=\"danger\">{row[3]}</Text>,\n                // g3: <Text type=\"danger\">{dict[row[2]]}</Text>\n                // g3: dict[row[3]]\n                ICD_10: row[0],\n                ICD_9: row[1],\n                g1: row[2],\n                g2: row[3],\n                g3: undefined\n              });\n            }\n            if (row.includes(undefined) == false) {\n\n              newRows.push({\n                key: index,\n                ICD_10: row[0],\n                ICD_9: row[1],\n                g1: row[2],\n                g2: row[3],\n                g3: dict[row[2]]\n              });\n            }\n          }\n        });\n        if (newRows.length === 0) {\n          this.setState({\n            errorMessage: \"No data found in file!\"\n          });\n          return false;\n        } else {\n          this.setState({\n            cols: resp.cols,\n            rows: newRows,\n            errorMessage: null\n          });\n        }\n      }\n    });\n    return false;\n  };\n\n  handleSubmit = async () => {\n    // console.log(\"submitting: \", this.state.rows);\n    const data = this.state.rows ? this.state.rows : '';//tabular data\n    var option = {};\n    let dataTable = [];\n    let datas = []\n    if (data) {\n\n      data.map((row) => {\n        datas.push(\n          row['g3']\n        )\n        let obj = {\n          'ICD-10': row['ICD_10'],\n          'ICD-9': row['ICD_9'],\n          'รหัสกรมบัญชีกลาง.': row['g1'],\n          'อุปกรณ์': row['g2'],\n          'อัตราจ่าย': row['g3'],\n        }\n        dataTable.push(obj);\n      });\n      // for (let i in data) {\n      //   if(data){\n      //     let obj = {\n      //                  'Organization ID': data[i].id,\n      //                  'Organization code': data[i].organization_code,\n      //                  'Organization name': data[i].organization_name,\n      //     }\n      //     dataTable.push(obj);\n      //   }\n      // }\n    }\n    option.fileName = this.state.name;\n    option.datas = [\n      {\n        sheetData: dataTable,\n        sheetName: 'sheet',\n        sheetFilter: ['ICD-10', 'ICD-9', 'รหัสกรมบัญชีกลาง.', 'อุปกรณ์', 'อัตราจ่าย'],\n        sheetHeader: ['ICD-10', 'ICD-9', 'รหัสกรมบัญชีกลาง.', 'อุปกรณ์', 'อัตราจ่าย'],\n      }\n    ];\n\n    if (!datas.includes(undefined) && datas.length !== 0) {\n      var toExcel = new ExportJsonExcel(option);\n      toExcel.saveExcel();\n    } else {\n      this.error()\n    }\n\n    // this.state.rows.map((row) => {\n    //   console.log(row['g1'])\n    // });\n    //submit to API\n    //if successful, banigate and clear the data\n    //this.setState({ rows: [] })\n  };\n\n  handleDelete = key => {\n    const rows = [...this.state.rows];\n    this.setState({ rows: rows.filter(item => item.key !== key) });\n  };\n\n  logout = () => {\n    window.location = '/'\n  }\n  handleAdd = () => {\n    const { count, rows } = this.state;\n    const newData = {\n      key: count,\n      name: \"User's name\",\n      age: \"22\",\n      gender: \"Female\"\n    };\n    this.setState({\n      rows: [newData, ...rows],\n      count: count + 1\n    });\n  };\n\n  render() {\n    // const components = {\n    //   body: {\n    //     row: EditableFormRow,\n    //     cell: EditableCell\n    //   }\n    // };\n    const columns = this.state.columns.map(col => {\n      if (!col.editable) {\n        return col;\n      }\n      return {\n        ...col,\n        onCell: record => ({\n          record,\n          editable: col.editable,\n          dataIndex: col.dataIndex,\n          title: col.title,\n          handleSave: this.handleSave\n        })\n      };\n    });\n    return (\n      <div style={{ paddingTop: 20, paddingLeft: 20, paddingRight: 20 }}>\n        <div style={{ textAlign: 'end' }}>\n          <Button\n            onClick={this.logout}\n            size=\"large\"\n            type=\"danger\"\n          // style={{ marginBottom: 16, marginLeft: 10 }}\n          >\n            ออกจากระบบ\n                  <Icon type=\"arrow-right\" />\n          </Button>\n        </div>\n        <Row gutter={24}>\n          <Col\n            span={8}\n            style={{\n              display: \"flex\",\n              justifyContent: \"space-between\",\n              alignItems: \"center\",\n              marginBottom: \"2%\"\n            }}\n          >\n            <Upload\n              name=\"file\"\n              beforeUpload={this.fileHandler}\n              onRemove={() => this.setState({ rows: [] })}\n              multiple={false}\n            >\n              <Button>\n                <Icon type=\"upload\" /> นำเข้าไฟล์ Excel\n            </Button>\n            </Upload>\n\n          </Col>\n          <Col span={8}>\n            {this.state.rows.length > 0 && (\n              <>\n                <Button type=\"primary\" shape=\"round\" size='large'\n                  onClick={this.handleSubmit}\n                >\n                  <Icon type=\"download\" />\n          ส่งออกไฟล์ Excel\n        </Button>\n              </>\n            )}\n          </Col>\n\n        </Row>\n        {/* <div>\n          <Upload\n            name=\"file\"\n            beforeUpload={this.fileHandler}\n            onRemove={() => this.setState({ rows: [] })}\n            multiple={false}\n          >\n            <Button>\n              <Icon type=\"upload\" /> นำเข้าไฟล์ Excel\n            </Button>\n          </Upload>\n\n          <Button\n            onClick={this.handleSubmit}\n            size=\"large\"\n            type=\"primary\"\n            style={{ marginBottom: 16, marginLeft: 10 }}\n          >\n            Submit Data\n                </Button>\n          <Button\n            onClick={this.logout}\n            size=\"large\"\n            type=\"primary\"\n            style={{ marginBottom: 16, marginLeft: 10 }}\n          >\n            ออกจากระบบ\n                </Button>\n        </div> */}\n        <div style={{ marginTop: 20 }}>\n          {/* <Table\n            bordered\n            // pagination={false}\n            // components={components}\n            // rowClassName={() => \"editable-row\"}\n            dataSource={this.state.rows}\n            // columns={columns}\n          /> */}\n          {/* <Table columns={columns} dataSource={this.state.rows} /> */}\n        </div>\n      </div>\n    );\n  }\n}\n","C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\utils\\editable.js",[],"C:\\Users\\PHATTARAPHON\\Desktop\\work\\readeditexcel\\src\\components\\login.js",["47","48","49","50","51","52","53","54","55"],{"ruleId":"56","severity":1,"message":"57","line":21,"column":10,"nodeType":"58","messageId":"59","endLine":21,"endColumn":19},{"ruleId":"56","severity":1,"message":"60","line":21,"column":21,"nodeType":"58","messageId":"59","endLine":21,"endColumn":34},{"ruleId":"56","severity":1,"message":"61","line":22,"column":8,"nodeType":"58","messageId":"59","endLine":22,"endColumn":17},{"ruleId":"56","severity":1,"message":"62","line":47,"column":7,"nodeType":"58","messageId":"59","endLine":47,"endColumn":18},{"ruleId":"63","replacedBy":"64"},{"ruleId":"65","replacedBy":"66"},{"ruleId":"56","severity":1,"message":"67","line":2,"column":10,"nodeType":"58","messageId":"59","endLine":2,"endColumn":15},{"ruleId":"56","severity":1,"message":"68","line":2,"column":25,"nodeType":"58","messageId":"59","endLine":2,"endColumn":35},{"ruleId":"56","severity":1,"message":"69","line":2,"column":73,"nodeType":"58","messageId":"59","endLine":2,"endColumn":78},{"ruleId":"56","severity":1,"message":"70","line":4,"column":10,"nodeType":"58","messageId":"59","endLine":4,"endColumn":25},{"ruleId":"56","severity":1,"message":"71","line":4,"column":27,"nodeType":"58","messageId":"59","endLine":4,"endColumn":39},{"ruleId":"56","severity":1,"message":"72","line":6,"column":9,"nodeType":"58","messageId":"59","endLine":6,"endColumn":13},{"ruleId":"73","severity":1,"message":"74","line":173,"column":45,"nodeType":"75","messageId":"76","endLine":173,"endColumn":47},{"ruleId":"77","severity":1,"message":"78","line":175,"column":41,"nodeType":"79","messageId":"80","endLine":175,"endColumn":43},{"ruleId":"77","severity":1,"message":"78","line":192,"column":41,"nodeType":"79","messageId":"80","endLine":192,"endColumn":43},{"ruleId":"73","severity":1,"message":"74","line":230,"column":22,"nodeType":"75","messageId":"76","endLine":230,"endColumn":24},{"ruleId":"56","severity":1,"message":"81","line":308,"column":11,"nodeType":"58","messageId":"59","endLine":308,"endColumn":18},{"ruleId":"56","severity":1,"message":"68","line":2,"column":52,"nodeType":"58","messageId":"59","endLine":2,"endColumn":62},{"ruleId":"56","severity":1,"message":"69","line":2,"column":95,"nodeType":"58","messageId":"59","endLine":2,"endColumn":100},{"ruleId":"56","severity":1,"message":"61","line":5,"column":8,"nodeType":"58","messageId":"59","endLine":5,"endColumn":17},{"ruleId":"77","severity":1,"message":"78","line":125,"column":29,"nodeType":"79","messageId":"80","endLine":125,"endColumn":31},{"ruleId":"77","severity":1,"message":"78","line":125,"column":63,"nodeType":"79","messageId":"80","endLine":125,"endColumn":65},{"ruleId":"73","severity":1,"message":"74","line":254,"column":53,"nodeType":"75","messageId":"76","endLine":254,"endColumn":55},{"ruleId":"73","severity":1,"message":"74","line":317,"column":28,"nodeType":"75","messageId":"76","endLine":317,"endColumn":30},{"ruleId":"77","severity":1,"message":"78","line":429,"column":35,"nodeType":"79","messageId":"80","endLine":429,"endColumn":37},{"ruleId":"77","severity":1,"message":"78","line":429,"column":70,"nodeType":"79","messageId":"80","endLine":429,"endColumn":72},"no-unused-vars","'useRoutes' is defined but never used.","Identifier","unusedVar","'BrowserRouter' is defined but never used.","'ExcelPage' is defined but never used.","'rootElement' is assigned a value but never used.","no-native-reassign",["82"],"no-negated-in-lhs",["83"],"'Table' is defined but never used.","'Popconfirm' is defined but never used.","'Space' is defined but never used.","'EditableFormRow' is defined but never used.","'EditableCell' is defined but never used.","'Text' is assigned a value but never used.","array-callback-return","Array.prototype.map() expects a return value from arrow function.","ArrowFunctionExpression","expectedInside","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","'columns' is assigned a value but never used.","no-global-assign","no-unsafe-negation"]